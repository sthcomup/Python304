缓存

==scrapy -->  8/10==

Git SVA

Mysql和nosql的区别

##### 

​	

1.redis --> 复看

##### queue

​	PriorityQueue（）--> !!!

​	Queue(FIFO)

​	LifoQueue()

### TCP 协议/UDP协议

#### TCP

+ TCP是面向连接的通讯协议，通过三次握手建立连接，通讯时完成四次挥手
+ 优点：
  + TCP在数据传输时，有确认，窗口，重传，阻塞等控制机制，能保证数据的正确性，较为可靠
  + TCP相对于UDP速度慢一点，要求系统资源较多



#### UDP

+ UDP是面向无连接的通讯协议，UDP数据包括目的端口号和源端口号信息。
+ 优点：
  + 传输速度快，操作简单，要求系统资源少，由于通讯不需要连接，可以实现广播发送
+ 缺点：
  + 由于UDP是无连接的，所有它并不知道接收端是否正确接收，也不重复发送，容易出现丢包现象







### 多进程。线程。协程

#### 进程

+ 进程 之间的通信由操作系统传递，导致通讯效率低，切换开销大
+ 密集CPU任务，需要充分利用多核CPU资源（大量并行计算）的时候
  - 缺陷：成本高，开销大

#### 线程

- 线程分享进程的内存空间，通讯效率高，切换开销小。共享意味着竞争，导致数据不安全，可以引用“互斥锁”

- 而在cpython中，有GIL（全局解释器锁）：

  - 线程执行权限，进程中只有一个GIL

    - 好处：杜绝多个线程访问内存空间的安全问题

    - 坏处：不是真正的多线程，不能充分利用多核CPU的资源

  - 在I/O阻塞时，解释器会释放GIL

- 密集型I/O任务，使用多线程
  - 缺陷：同一时间切片只能运行一个线程，不能做到高并行，但可以做到==高并发==

#### 协程

- 在单线程上执行多个任务，用函数切换，开销极小。
  - genvent, monkey.patchall

- 多线程请求返回是无序的，而协程返回的数据是有序的
- 缺陷：单线程执行，处理密集CPU和本地磁盘I/O时，性能低。处理网络I/O性能高

### Docker

+ ###### 什么是Docker
  
  + 开源的应用容器引擎, 基于 [Go 语言](https://www.runoob.com/go/go-tutorial.html) 并遵从Apache2.0协议开源 
  + docker 重新定义了程序开发测试，交付和部署过程的开放平台。
  + docker可以保持开发，测试和生产环节高度一致
+ docker 利用了namespace 来做权限的控制和隔离， cgroups 进行资源的配置，通过 aufs 进一步提高文件系统的资源了利用率
+ 相对于VM，优势：
  + 启动速度快
  + 资源利用率高
  + 性能开销小



### Django 开发中对数据库的优化：

1. 设计表时，尽量少使用外键，影响插入和删除性能
2. 使用缓存， 减少数据库的访问
3. 在orm框架设计表时，能用varchar，就别用text
4. 给搜索高频的字段属性，在定义时创建索引
5. 在模块标签里使用with标签可以缓存Qset的查询结果

### Django 提升性能（高并发）

+ ##### 后端提升性能指标：
  
  + 并发数
+ 响应时间
  
+ #### web网站性能的优化：
  
  + web前端性能优化
    + 1.减少 http 请求，减少数据库的访问量，比如使用雪碧图。 
    + 2.使用浏览器缓存，将一些常用的 css，js，logo 图标，这些静态资源缓存到本地浏览器，通过设
      置 http 头中的 cache-control 和 expires 的属性，可设定浏览器缓存，缓存时间可以自定义。
    +  3 对 html，css，javascript 文件进行压缩，减少网络的通信量。
  + 应用服务器--
+ 储存服务器--
  
+ #### 解决 -优化

  + 合理应用缓存，对常用的动态数据，比如首页做缓存，或者其他常用的数据，并设置过期时间，减少数据库压力，提升网站性能
  + 使用celery消息队列，将耗时的操作放队列，让worker去监听队列任务，实现异步操作，如发邮件，发短信
  + nginx部署项目，提升效率，增加并发量
  + 搭建服务器集群，将并发访问请求分散到多台服务器上处理
  + 最后就是运维工作人员的性能优化技术了

### 高并发

+ ##### 什么是高并发

  +  通过设计保证系统能够同时并行处理很多请求 
    +  高并发相关常用的一些指标：
       +  响应时间（Response Time）
       +  吞吐量（Throughput）
       +  每秒查询率QPS（Query Per Second）
       +  并发用户数等 

+ ##### 如何提升系统的并发能力

  +  垂直扩展（Scale Up） 
    +  增强单机硬件性能，例如：增加CPU核数如32核，升级更好的网卡如万兆，升级更好的硬盘如SSD，扩充硬盘容量如2T，扩充系统内存如128G；
    +   提升单机架构性能，例如：使用Cache来减少IO次数，使用异步来增加单服务吞吐量，使用无锁数据结构来减少响应时间；  
  +  水平扩展（Scale Out） 
    +  只要增加服务器数量，就能线性扩充系统性能。水平扩展对系统架构设计是有要求的 

+ ##### 解决方式：

  + HTML页面静态化

  + 2.图片服务器分离（我使用的是fastdfs轻量级的分布式文件存储系统）

  + 3.使用缓存（缓存存在于内存中读取快我的项目中使用redis作为缓存的数据库，redis是内存型数据作为存储缓存的数据库挺适合）

  + 4.数据库集群、库表散列

  + 5.使用负载均衡的方法（简单的配置可以用nginx来配置负载均衡，只需要设置 如下代码，即可实现简单的负载均衡

    ```
     upstream djangoserver {  
                 server 192.168.72.49:8080;  
                 server 192.168.72.49:8081;  
              } 
    ```

  + 6.镜像
  + 7.最新：CDN加速技术（此技术还在了解阶段，可自行去网上查找相关的资料）

### Mysql， MongoDB， Redis

+ ##### MongoDB

  + 优点
    + 1.==性能优越:快速！==在适量级的内存的 MongoDB 的性能是非常迅速的，它将热数据存储在物理内存中，使得热数据的读写变得十分快，
    + 2.==高扩展==:第三方支持丰富(这是与其他的 No SQL 相比，MongoDB 也具有的优势)
    + 3.自身的 ==Failover 机制==！
    +  4.==弱一致性==（最终一致），更能保证用户的访问速度 
    +  5.文档结构的存储方式，能够更便捷的获取数据: json 的存储格式
    + 6.==支持大容量的存储==,内置 GridFS 
    +  7.内置 Sharding 
  + 缺点：
    +   MongoDB 不支持事务操作(最主要的缺点)
    + MongoDB 占用空间过大
    +  MongoDB 没有如 MySQL 那样成熟的维护工具，这对于开发和IT运营都是个值得注意的地方

+ ##### MongoDB 和 Redis 的区别：

  + ######  简介

    + MongoDB 更类似 MySQL，支持字段索引、游标操作，其优势在于查询功能比较强大，擅长查询 JSON 数据，能存储海量数据，但是不支持事务。
    + MySQL 在大数据量时效率显著下降，MongoDB 更多时候作为关系数据库的一种替代。

  + ###### 集群

    + MongoDB 集群技术比较成熟，Redis从3.0开始支持集群。 

  + ###### 内存管理机制

    + Redis 数据全部存在内存，定期写入磁盘，当内存不够时，可以选择指定的 LRU 算法删除数据。
    +  MongoDB 数据存在内存，由 linux系统 mmap 实现，当内存不够时，只将热点数据放入内存，其他数据存在磁盘。


  + ###### 支持的数据结构

    + Redis 支持的数据结构丰富，包括hash、set、list等。
    +  MongoDB 数据结构比较单一（K-V），但是支持丰富的数据表达，索引，最类似关系型数据库，支持的查询语言非常丰富。


  + ###### 不适用的场景

    Ø  需要使用复杂sql的操作

     Ø  事务性系统 

### Nginx和uWSGI

+ nginx
  + 它是一个开源的高性能的HTTP服务器和反向代理
    1. 作为web服务器，他处理静态和索引文件的效果非常高
    2. 最大支持5W个并发连接，但占用很少的内存空间
    3. 稳定性高，配置简洁
       1. 强大的反向代理和负载均衡功能，平衡集群各个服务器负载压力的应用
  + uWSGI -- web服务器
    + 实现WSGI，uwsgi，http等协议
    + WSGI 是一种通信协议。
      + WSGI 是一种Web 服务器网关接口。
      + 它是一 个Web 服务器（如 nginx，uWSGI 等服务器）与 web 应用（如用 Flask 框架写的程序）通信的一种 规范。
    + uwsgi是一种线路协议而不是通信协议，在此常用于在 uWSGI 服务器与其他网络服务器的数据通信
    + uWSGI 是实现了 uwsgi 和WSGI 两种协议的Web 服务器。

### HTTP和HTTPS

+ ##### 主要区别：

  + HTTPS需要ca证书，需要一定的费用
  + HTTP是超文本传输协议，是无状态的；HTTPS是HTTP，SSL协议构建的可进行加密传输，身份认证的网络协议，比http更安全
  + 使用的端口不同，HTTP使用80，HTTPS使用443

+ ##### ***为什么大多数公司选择http而不选择https：***

  1. HTTPS在“握手阶段”比较耗时，而且连接缓存也不如HTTP高效，所以，HTTPS没HTTP速度快
  2. SSL证数（CA证书）是需要花钱的，并且需要每年投入，对很多小公司和个人开发者挡住了
  3. HTTPS对服务器资源占用率高， 也就是需要在硬件投入上花费更多。